$ mkdir d
$ cd d

$ whoami
> root

$ touch a b c d e f
$ richacl --set 'owner@:rwaxdTtDMmosNneE::allow' a
$ richacl --set 'owner@:rwaxdTtDMmosNneE::allow bin:w::allow' b
$ richacl --set 'owner@:rwaxdTtDMmosNneE::allow bin:a::allow' c
$ richacl --set 'owner@:rwaxdTtDMmosNneE::allow bin:wa::allow' d
$ richacl --set 'bin:a::deny owner@:rwaxdTtDMmosNneE::allow bin:w::allow' e
$ richacl --set 'bin:w::deny owner@:rwaxdTtDMmosNneE::allow bin:a::allow' f

$ su bin
$ echo a 2>/dev/null > a || echo "Expected failure"
> Expected failure
$ echo b > b
$ echo c 2>/dev/null > c || echo "Expected failure"
> Expected failure
$ echo d > d
$ echo e > e
$ echo f 2>/dev/null > f || echo "Expected failure"
> Expected failure

$ echo A 2>/dev/null >> a || echo "Expected failure"
> Expected failure
$ echo B 2>/dev/null >> b || echo "Expected failure"
> Expected failure
$ echo C >> c
$ echo D >> d
$ echo E 2>/dev/null >> e || echo "Expected failure"
> Expected failure
$ echo F >> f

$ su
$ cat a b c d e f
> b
> C
> d
> D
> e
> F

$ cd ..
$ rm -rf d
